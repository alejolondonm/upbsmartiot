# Utilizar una imagen base de Python 3.8
FROM python:3.8

# Instalar cron y vim (opcional)
RUN apt-get update && apt-get -y install cron vim

# Establecer el directorio de trabajo
WORKDIR /app

# Copiar el archivo de dependencias y luego instalar las dependencias de Python
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Copiar el script principal de la aplicaci√≥n, el archivo crontab, y el script de inicio
COPY app.py .
COPY crontab /etc/cron.d/crontab
COPY start.sh .

# Dar permisos correctos al archivo de crontab y cargarlo en cron
RUN chmod 0644 /etc/cron.d/crontab
RUN crontab /etc/cron.d/crontab

RUN chmod +x /app/start.sh

CMD ["/app/start.sh"]